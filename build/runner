#!/bin/bash
#be in this directory whatever happens
DIR=$( cd "$( dirname "${BASH_SOURCE[0]}" )" && pwd )
cd "${DIR}"

# DECLARE AND EXPORT ALL SHARED CONSTS

# this is about the remote database
declare -x db="q122303_qp"
declare -x dbuser="q122303admin"

#this about the remote site. (rem: the workingDir is 'hidden' from ls unless we swap to it)
user="butter100fly"
declare -x sflogin="$user,quickplay@shell.sourceforge.net"
declare -x sfFileLogin="$user,quickplay@frs.sourceforge.net"
declare -x sfFilePath="/home/frs/project/quickplay/quickplay"
declare -x createLoginShell="ssh $sflogin create"
declare -x workingDir="/home/project-web/quickplay"

#and we want to send all those to the ssh session later
#plus we ALWAYS switch to the working dir, as that's where to DB's are....
#plus we want to always check if we've got a login shell, and make one if we haven't
declare -x SSHEnvVars="db="$db"; dbuser="$dbuser"; workingDir="$workingDir";cd "$workingDir";sfFilePath="$sfFilePath";"

#all these involve saving the DB locally
#  rsync interprets ":" as separator between host and port (i. e. host:port)
#  so we cannot use %T or %H:%M:%S here, so we use %H-%M-%S
declare -x date=`date "+%FT%H-%M-%S"` 
declare -x sqlFolder="../../database"
declare -x sqlArchiveFolder="$sqlFolder/archive"
declare -x sqlArchiveFile="$sqlArchiveFolder"/"$db"-"$date"
declare -x sqlLiveFile="$sqlFolder/$db.sql"

# and these are about the local site and resources
declare -x pathToSecrets="../../secrets"
declare -x secret_file_to_test="../includes/class.database.php"
declare -x secret_file_to_diff="$pathToSecrets/class.database_blank.php"
declare -x MAMPDir="/Applications/MAMP"
declare -x mySQLDir="$MAMPDir/Library/bin"

declare -x warn="***SHUT MAMP WHEN YOU'RE DONE***"

./menu
