#!/bin/bash

. switcher

let failedTests=0



# test files will live in serets dir
testFile="../../secrets/secretsRegexTestFile"
resultsFile="${testFile}Result"

echo "get new results file (copying $testFile to $resultsFile)"
cp $testFile $resultsFile

echo "Refreshed $resultsFile - Do you want to run the tests? [y/n]" && read answer
if echo "$answer" | grep -q "^y" 
	then echo "continuing"
	else echo "exiting" && exit
fi

testValue="testValue"

echo "Test 1 - replace AdminSettings.php"
configKey="$wgDBadminpassword" 
replacePHPConfig "$configKey" "$testValue" "$resultsFile"

test1Result=$( { cat $resultsFile && echo "<?php echo $testValue ?>" ;}  | php )
if [[ $test1Result == $testValue ]]; then
 	echo "Success - test result is $test1Result"
else
	echo "Failiure - test result is $test1Result"	
fi


